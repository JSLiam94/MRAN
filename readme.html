<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h2 id="preprocessing">Preprocessing</h2>
<h4 id="导入实验虚拟环境">导入实验虚拟环境</h4>
<pre><code>conda env -f mran.yaml
</code></pre>
<p>进入环境</p>
<pre><code>conda activate mran
</code></pre>
<h4 id="处理原始病理图像">处理原始病理图像</h4>
<p>示例数据集下载: <a href="https://drive.google.com/file/d/13Fb2U59KiXnhqLfjSwgZ3Vpr2uBf7c2I/view?usp=sharing">链接1</a> <a href="https://pan.baidu.com/s/1C-xuMsTrVKLYyEGONUocwg?pwd=pz75">链接2</a><br>
将example解压至WSI目录下</p>
<pre><code>cd pre
python run_preprocess.py
</code></pre>
<p>数据集存放形式参考WSI/example:<br>
dataset/*/slide_1.svs<br>
…<br>
dataset/*/slide_n.svs<br>
因为采用TCGA的数据集，每张图像的文件名slide_i的前12位为其case id.</p>
<h4 id="划分数据集">划分数据集</h4>
<pre><code>cd pre
python pro_csv.py
</code></pre>
<p>原始数据集的标签文件格式参考csv/example/sheet/total.csv：</p>

<table>
<thead>
<tr>
<th>File Name</th>
<th>Sample Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>slide_i.svs</td>
<td>Primary Tumor</td>
</tr>
<tr>
<td>slide_j.svs</td>
<td>Solid Tissue Normal</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table><h2 id="training">Training</h2>
<h4 id="训练">训练</h4>
<pre><code>python main.py
</code></pre>
<p>参数设置参考 main.yaml</p>
<h4 id="测试">测试</h4>
<pre><code>python test.py
</code></pre>
<p>目录output_dir的predict.csv记录测试集上的预测结果</p>
<h2 id="interpretability-experiment">Interpretability experiment</h2>
<pre><code>cd interpretability
python top_bag_top_patch.py
</code></pre>
<p>目录output_dir的tb_tp/*/中的predict.csv记录测试集上的预测结果</p>
</div>
</body>

</html>
